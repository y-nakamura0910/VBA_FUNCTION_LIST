Option Explicit

Public Sub function_exe()

    ' パスワードの指定
    Dim password As Variant
    password = 1234
    
    ' ブックの保護解除
    Call Module1.workbook_unprotect(password)
    
    ' シートの保護解除
    Call Module1.worksheet_unprotect(password)
    
    ' シートの保護
    Call Module1.worksheet_protect(password)
    
    ' ブックの保護
    Call Module1.workbook_protect(password)
End Sub

' ブックの保護
Private Sub workbook_protect(password As Variant)
    ThisWorkbook.Protect (password)
End Sub

' ブックの保護解除
Private Sub workbook_unprotect(password As Variant)
    ThisWorkbook.Unprotect (password)
End Sub

' シートの保護
Private Sub worksheet_protect(password As Variant)
    ThisWorkbook.Worksheets(1).Protect (password)
End Sub

' シートの解除
Private Sub worksheet_unprotect(password As Variant)
    ThisWorkbook.Worksheets(1).Unprotect (password)
End Sub

